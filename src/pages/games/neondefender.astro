---
import fs from 'node:fs';
import path from 'node:path';

const htmlPath = path.resolve(process.cwd(), 'public/games/neondefender/index.html');
const rawHtml = fs.readFileSync(htmlPath, 'utf-8');
const config = {
  geminiApiKey: import.meta.env.PUBLIC_GEMINI_API_KEY || process.env.PUBLIC_GEMINI_API_KEY || '',
  firebaseApiKey: import.meta.env.PUBLIC_FIREBASE_API_KEY || process.env.PUBLIC_FIREBASE_API_KEY || '',
  env: import.meta.env.DEV ? 'dev' : 'prod'
};
const injectedHtml = rawHtml.replace(
  /<script id="neon-config" type="application\/json">[\s\S]*?<\/script>/,
  `<script id="neon-config" type="application/json">${JSON.stringify(config)}</script>`
);
---
<Fragment set:html={injectedHtml} />
